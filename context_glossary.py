# context_glossary.py
"""
AIã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç†è§£ã‚’å¼·åŒ–ã™ã‚‹ãŸã‚ã®ãƒ“ã‚¸ãƒã‚¹ç”¨èªé›†
"""

BUSINESS_CONTEXT_GLOSSARY = {
    # =========================================================================
    # é‡è¦KPI (Key Performance Indicator)
    # =========================================================================
    "ROAS": {
        "full_name": "Return On Advertising Spend (åºƒå‘Šè²»ç”¨å¯¾åŠ¹æœ)",
        "definition": "åºƒå‘Šè²»ã«å¯¾ã—ã¦ã©ã‚Œã ã‘ã®å£²ä¸ŠãŒã‚ã£ãŸã‹ã‚’ç¤ºã™æŒ‡æ¨™ã€‚é«˜ã„ã»ã©è‰¯ã„ã€‚",
        "calculation": "SUM(ConversionValue) / SUM(CostIncludingFees)",
        "analysis_point": "ROASãŒæ¥­ç•Œãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ï¼ˆä¾‹: 4.2å€ï¼‰ã‚’ä¸Šå›ã£ã¦ã„ã‚‹ã‹ã€ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æ¯ã®ROASã‚’æ¯”è¼ƒã—ã¦äºˆç®—é…åˆ†ã®æœ€é©åŒ–ã‚’æ¤œè¨ã™ã‚‹ã€‚"
    },
    "F2è»¢æ›ç‡": {
        "full_name": "F2 Transition Rate (åˆå›ãƒªãƒ”ãƒ¼ãƒˆç‡)",
        "definition": "æ–°è¦é¡§å®¢ãŒ2å›ç›®ã®è³¼å…¥ã«è‡³ã£ãŸå‰²åˆã€‚é¡§å®¢ã®å®šç€åº¦ã‚’ç¤ºã™ã€‚",
        "calculation": "(2å›ç›®ã®è³¼å…¥è€…æ•° / æ–°è¦é¡§å®¢æ•°) * 100",
        "analysis_point": "ã©ã®åºƒå‘ŠçµŒç”±ã®é¡§å®¢ãŒF2è»¢æ›ç‡ãŒé«˜ã„ã‹ã‚’åˆ†æã—ã€LTVï¼ˆé¡§å®¢ç”Ÿæ¶¯ä¾¡å€¤ï¼‰ã®é«˜ã„é¡§å®¢å±¤ã‚’ç‰¹å®šã™ã‚‹ã€‚"
    },
    "LTV": {
        "full_name": "Life Time Value (é¡§å®¢ç”Ÿæ¶¯ä¾¡å€¤)",
        "definition": "ä¸€äººã®é¡§å®¢ãŒå–å¼•æœŸé–“ä¸­ã«ä¼æ¥­ã«ã‚‚ãŸã‚‰ã™ç·åˆ©ç›Šã€‚",
        "calculation": "å¹³å‡é¡§å®¢å˜ä¾¡ * å¹³å‡è³¼è²·é »åº¦ * å¹³å‡ç¶™ç¶šæœŸé–“",
        "analysis_point": "LTVã®é«˜ã„é¡§å®¢ã‚’ç²å¾—ã§ãã¦ã„ã‚‹ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚’ç‰¹å®šã—ã€ãã®åºƒå‘Šã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã‚„ã‚¿ãƒ¼ã‚²ãƒ†ã‚£ãƒ³ã‚°ã‚’åˆ†æã™ã‚‹ã€‚"
    },
    
    # =========================================================================
    # ç¤¾å†…ç”¨èªãƒ»ç•¥èª
    # =========================================================================
    "æ˜¥æœ¬ç•ªCP": {
        "full_name": "æ˜¥ã®æœ¬ç•ªã‚»ãƒ¼ãƒ«ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³",
        "definition": "æ¯å¹´3æœˆã€œ4æœˆã«å®Ÿæ–½ã•ã‚Œã‚‹å¤§è¦æ¨¡ãªè²©å£²ä¿ƒé€²ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã€‚",
        "analysis_point": "æ˜¨å¹´ã®åŒã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã¨æ¯”è¼ƒã—ã¦ã€ä»Šå¹´ã®æˆæœãŒã©ã†ã ã£ãŸã‹ã‚’åˆ†æã™ã‚‹ã€‚ç‰¹ã«æ–°è¦é¡§å®¢ç²å¾—æ•°ã«ç€ç›®ã™ã‚‹ã€‚"
    },
    "æŒ‡åæ¤œç´¢": {
        "full_name": "Branded Search",
        "definition": "ç¤¾åã‚„å•†å“åãªã©ã€å›ºæœ‰åè©ã§ã®æ¤œç´¢æµå…¥ã€‚",
        "analysis_point": "æŒ‡åæ¤œç´¢ã«ã‚ˆã‚‹CVRã¯éå¸¸ã«é«˜ã„å‚¾å‘ã«ã‚ã‚‹ã€‚åºƒå‘Šè²»ã‚’å¢—ã‚„ã—ãŸæ™‚æœŸã«ã€æŒ‡åæ¤œç´¢æ•°ã‚‚å¢—åŠ ã—ã¦ã„ã‚‹ã‹ï¼ˆåºƒå‘Šã®èªçŸ¥åŠ¹æœï¼‰ã‚’ç¢ºèªã™ã‚‹ã€‚"
    },

    # =========================================================================
    # åˆ†æã®è¦–ç‚¹
    # =========================================================================
    "æ·±æ˜ã‚Šåˆ†æ": {
        "definition": "å˜ãªã‚‹æ•°å€¤ã®ç¾…åˆ—ã§ã¯ãªãã€ãã®æ•°å€¤ã®èƒŒæ™¯ã«ã‚ã‚‹ã€Œãªãœãã†ãªã£ãŸã®ã‹ï¼Ÿã€ã¨ã„ã†åŸå› ã‚’æ¢ã‚‹åˆ†æã‚¢ãƒ—ãƒ­ãƒ¼ãƒã€‚",
        "analysis_point": "ä¾‹ãˆã°CPAãŒæ‚ªåŒ–ã—ãŸå ´åˆã€ã©ã®ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã®ã€ã©ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ã€ã©ã®åºƒå‘Šæ–‡ã®ã‚¯ãƒªãƒƒã‚¯ç‡ãŒä¸‹ãŒã£ãŸã®ã‹ï¼Ÿã®ã‚ˆã†ã«ãƒ‰ãƒªãƒ«ãƒ€ã‚¦ãƒ³ã—ã¦è¦å› ã‚’ç‰¹å®šã™ã‚‹ã€‚"
    }
}

def get_glossary_for_prompt() -> str:
    """ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«åŸ‹ã‚è¾¼ã‚€ãŸã‚ã®æ•´å½¢æ¸ˆã¿ç”¨èªé›†ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹"""
    prompt_text = "## ğŸ“– ãƒ“ã‚¸ãƒã‚¹ç”¨èªé›†\n"
    prompt_text += "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æŒ‡ç¤ºã‚’è§£é‡ˆã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã®å®šç¾©ã‚’æœ€å„ªå…ˆã§å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚\n\n"

    for term, data in BUSINESS_CONTEXT_GLOSSARY.items():
        prompt_text += f"### {term} ({data.get('full_name', '')})\n"
        prompt_text += f"- **å®šç¾©**: {data['definition']}\n"
        if 'calculation' in data:
            prompt_text += f"- **è¨ˆç®—å¼**: `{data['calculation']}`\n"
        if 'analysis_point' in data:
            prompt_text += f"- **åˆ†æã®ãƒã‚¤ãƒ³ãƒˆ**: {data['analysis_point']}\n"
        prompt_text += "\n"
        
    return prompt_text